# US-005: Work Unit Generator — verify_finding

**Status:** done
**Model:** sonnet
**Component:** 2 (Work Unit Generator)
**Depends On:** US-001, US-003, US-004
**Traces To:** FR-012, FR-017, FR-018, FR-019, EC-002, EC-006, EC-007

## Description

Implements the `WorkUnit` dataclass and the `verify_finding` unit generator inside `src/sefi/generator/units.py`. Each generated unit contains a single claim drawn from the rhowardstone report data, one or more cited EFTA numbers, the corresponding resolved DOJ PDF URLs, and mandatory instruction text including the de-anonymization prohibition. The generator tracks assignment state and exposes `mark_unit_complete`.

## Files to Create / Modify

- `src/sefi/generator/units.py` — `WorkUnit` dataclass, `WorkUnitGenerator` class with `generate_unit()`, `mark_unit_assigned()`, `mark_unit_complete()` for `verify_finding` type
- `tests/unit/test_units_verify.py` — unit tests for field completeness, URL correctness, DS10 exclusion, de-anonymization prohibition text, source_verified flag, double-assignment prevention

## Acceptance Criteria

- [ ] A generated `verify_finding` unit contains all required fields: `unit_id`, `type`, `path`, `difficulty`, `scaling`, `optimal_batch`, `input`, `instructions`, `constraints`, `deadline` (FR-017)
- [ ] `input` for `verify_finding` units includes `claim` (non-empty string), `cited_eftas` (list with at least 1 EFTA-format string), `efta_urls` (list of valid DOJ PDF URLs matching cited_eftas in count and order) (FR-012)
- [ ] Every generated unit's `instructions` field contains the verbatim text: `"Do not attempt to infer or recover redacted content. Analyze patterns only."` (EC-007)
- [ ] No generated unit references DS10 content or image/video file types (EC-002)
- [ ] Every generated unit includes `source_verified: bool` — units derived from rhowardstone report claims have `source_verified=False` (EC-006)
- [ ] `generate_unit()` for an already-assigned `unit_id` either returns a different unit or raises; the same unit is never assigned to two workers simultaneously (FR-018)
- [ ] After `mark_unit_complete(unit_id)`, that unit does not appear in subsequent `generate_unit()` calls (FR-019)
- [ ] Generating 1,000 units produces a set of 1,000 distinct `unit_id` values (FR-049 partial — uniqueness)
- [ ] All fields include type annotations; Pydantic or dataclass validation raises on missing/wrong-type fields before the unit is returned (FR-017, NFR-002)
- [ ] All functions include docstrings (NFR-008)

## Notes

- `unit_id` format suggestion: `"verify-{uuid4_short}"` — use `uuid.uuid4().hex[:12]` for brevity and guaranteed uniqueness.
- `path=5` (Verification path), `difficulty="low"`, `scaling="linear"`, `optimal_batch="1 claim"` per the Work Unit Types Reference table.
- `constraints` dict must include `{"max_output_tokens": 2000, "pii_filter": True, "requires_quorum": False}`.
- `deadline` should default to 24 hours from unit creation time (ISO 8601 datetime string).
- Claims source: the generator reads from a pre-loaded list of claim objects (passed in at construction time or loaded from a JSON file in `data/`). For MVP, this list is small (~50 claims from rhowardstone reports). The generator cycles through unassigned claims.
- Assignment tracking: maintain an in-memory dict `{unit_id: worker_id | None}` and a set of `completed_unit_ids`. Both live on the `WorkUnitGenerator` instance.
- `WorkUnit` should be a `dataclass` with `__post_init__` validation, not a Pydantic model (Pydantic models are for API boundaries per NFR-003; internal data structures may use dataclasses).
